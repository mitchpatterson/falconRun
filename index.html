<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Falcon Run</title>

<script>var zon = true; // true for comments from zim code</script>
<script src="http://d309knd7es5f10.cloudfront.net/zim_1.4.4_min.js"></script>
<script src="http://code.createjs.com/createjs-2015.05.21.min.js"></script> 
<!-- should use CDN links available from CreateJS and ZIM sites -->

<style>
	body {margin:0px; padding:0px; background-color:#000;}
	#myCanvas {position:absolute; background-color:#000;/* cursor: none;*/}
</style>

<script>

var scaling = "fit"; // fit scales to fit the browser window while keeping the aspect ratio
var width = 960;
var height = 640;
var frame = new zim.Frame(scaling, width, height); 

frame.on("ready", function() {  
    console.log("ready from ZIM Frame");
    
    var stage = frame.stage;
    var stageW = frame.width;
    var stageH = frame.height;

    
    // used for tiles if there are tiles
    var squareW = 120;
    var squareH = 90;
    var squareS = 20;
    
    var imagePath = "img/";
    var manifest = [{id:"scrollerBack", src:"scrollerBack.png"},
                    {id:"scrollerMid", src:"scrollerMid.png"},
                    {id:"scrollerFront", src:"scrollerFront.png"},
                    {id:"falcon", src:"falcon.png"},
                    {id:"warningAsteroid", src:"warningAsteroid.png"}];

    var preload = new createjs.LoadQueue(false, imagePath);
    preload.loadManifest(manifest);
    preload.on("complete", game);
    
    
    function game() {
        console.log("____Star Wars Falcon Run____"); 

        var warningAsteroid = new createjs.Bitmap (preload.getResult("warningAsteroid"));

//  scroller Back

        var scrollerBack = new createjs.Bitmap (preload.getResult("scrollerBack"));
        stage.addChild(scrollerBack);

        var scrollerBack2 = new createjs.Bitmap (preload.getResult("scrollerBack"));
        stage.addChild(scrollerBack2);

        var scrollerSpeed = 3;
        var scroller1 = new zim.Scroller(scrollerBack, scrollerBack2, scrollerSpeed, -.05, false, 5);


// scroller Mid

        var scrollerMid = new createjs.Bitmap (preload.getResult("scrollerMid"));
        stage.addChild(scrollerMid);

        var scrollerMid2 = new createjs.Bitmap (preload.getResult("scrollerMid"));
        stage.addChild(scrollerMid2);

        var scroller2 = new zim.Scroller(scrollerMid, scrollerMid2, scrollerSpeed, -.08, false, 5);

// scroller Front

        var scrollerFront = new createjs.Bitmap (preload.getResult("scrollerFront"));
        stage.addChild(scrollerFront);

        var scrollerFront2 = new createjs.Bitmap (preload.getResult("scrollerFront"));
        stage.addChild(scrollerFront2);

        var scroller3 = new zim.Scroller(scrollerFront, scrollerFront2, scrollerSpeed, -.2, false, 5);

//  adding the falcon

        var falcon = new createjs.Bitmap (preload.getResult("falcon"));
        stage.addChild(falcon);
        falcon.x = stageW/2;
        falcon.y = stageH/5*4;
        zim.scale(falcon, .2);
        falcon.regX = falcon.getBounds().width/2;
        falcon.regY = falcon.getBounds().height/2;
       
// damping function

        var damp = new zim.Damp(null, .04);
        var damp2 = new zim.Damp(null, .04);


        createjs.Ticker.framerate = 60;
        createjs.Ticker.on("tick", function(){
            falcon.x = damp.convert(stage.mouseX);
            // falcon.y = damp2.convert(stage.mouseY);
            console.log(scrollerMid.y);

            if((scrollerMid.y > 50 && scrollerMid.y < 57) || (scrollerMid.y > 64 && scrollerMid.y < 71) || (scrollerMid.y > 78 && scrollerMid.y < 85)|| (scrollerMid.y > 92 && scrollerMid.y < 99)|| (scrollerMid.y > 106 && scrollerMid.y < 113)){
                warningAsteroid.regX = warningAsteroid.getBounds().width/2;
                warningAsteroid.regY = warningAsteroid.getBounds().height/2;
                warningAsteroid.x = stageW/2; 
                warningAsteroid.y = stageH/2; 
                zim.scale(warningAsteroid, .7);

                   stage.addChild(warningAsteroid);
                   stage.update();

        

            } else {
                stage.removeChild(warningAsteroid);
            }
            stage.update();
        });



        stage.update(); 
    } 

});



</script>


</head>

<body>
</body>
</html>